<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='Performs simulation-based inference as an alternative to the delta method for obtaining valid confidence intervals and p-values, which is especially useful when the resulting quantity is not normally distributed and the delta method approximation fails. The framework for simulation-based inference is described in King, Tomz, and Wittenberg (2000) &lt;doi:10.2307/2669316&gt;. clarify is meant to replace some of the functionality of Zelig; see the vignette "Translating Zelig to clarify" for replicating this functionality.'>
<title>Simulation-Based Inference for Regression Models • clarify</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulation-Based Inference for Regression Models">
<meta property="og:description" content='Performs simulation-based inference as an alternative to the delta method for obtaining valid confidence intervals and p-values, which is especially useful when the resulting quantity is not normally distributed and the delta method approximation fails. The framework for simulation-based inference is described in King, Tomz, and Wittenberg (2000) &lt;doi:10.2307/2669316&gt;. clarify is meant to replace some of the functionality of Zelig; see the vignette "Translating Zelig to clarify" for replicating this functionality.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">clarify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/clarify.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/Zelig.html">Translating Zelig to clarify</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ngreifer/clarify/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="clarify-simulation-based-inference-for-regression-models">
<code>{clarify}</code>: Simulation-Based Inference for Regression Models<a class="anchor" aria-label="anchor" href="#clarify-simulation-based-inference-for-regression-models"></a>
</h1></div>
<!-- badges: start -->

<p><a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a> implements simulation-based inference as an alternative to the delta method for computing functions of model parameters, such as average marginal effects.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ngreifer/clarify"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Simulation-based inference is an alternative to the delta method and bootstrapping for performing inference on quantities that are functions of model parameters. The delta method involves multiple assumptions: 1) the regression coefficients are normally distributed, 2) the resulting quantity of interest is normally distributed, and 3) the first-order approximation to the variance of the desired estimator is equal to the true variance. When these assumptions are incorrect, which is especially likely when the quantity of interest is a complicated nonlinear function of the model coefficients, the resulting inferences can be inaccurate. Bootstrapping is one solution to this problem that does not require any of the above assumptions for valid nonparametric inference; however, it is computationally intensive since the original model needs to be fit many times, and any problems with the model that are only apparent in some bootstrap samples (e.g., failure to converge, perfect prediction) can make using bootstrapping challenging.</p>
<p>Simulation-based inference provides a compromise to these two methods: it is more accurate than the delta method because it does not require assumptions 2) and 3), and it is faster and more stable than bootstrapping because the model only needs to be fit once. Simulation-based inference involves simulating model coefficients from their multivariate distribution using their estimated values and covariance from a single model fit to the original data, computing the quantities of interest from each set of model coefficients, and then performing inference using the resulting distribution of the estimates as their sampling distribution. Confidence intervals can be computed using the percentiles of the resulting sampling distribution, and p-values can be computed by inverting the confidence intervals. Alternatively, if the resulting sampling distribution is normally distributed, its standard error can be estimated as the standard deviation of the estimates and normal-theory confidence intervals and p-values can be computed.</p>
<p>The <a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a> package was designed to provide a simple, general interface to simulation-based inference, along with a few convenience functions to perform common tasks like computing average marginal effects. The primary functions of <a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a> are <code><a href="reference/sim.html">sim()</a></code>, <code><a href="reference/sim_apply.html">sim_apply()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. These work together to create a simple workflow for simulation-based inference.</p>
<ul>
<li>
<code><a href="reference/sim.html">sim()</a></code> simulates model parameters from a fitted model</li>
<li>
<code><a href="reference/sim_apply.html">sim_apply()</a></code> applies an estimator to the simulated coefficients, or to the original object but with the new coefficients inserted</li>
<li>
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> produces confidence intervals and p-values for the resulting estimates</li>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> produces plots of the simulated sampling distribution of the resulting estimates</li>
</ul>
<p>There are also some wrappers for <code><a href="reference/sim_apply.html">sim_apply()</a></code> for performing some common operations: <code><a href="reference/sim_ame.html">sim_ame()</a></code> computes the average marginal effect of a variable, mirroring <code><a href="https://vincentarelbundock.github.io/marginaleffects/reference/comparisons.html" class="external-link">marginaleffects::comparisons()</a></code> and <code><a href="https://vincentarelbundock.github.io/marginaleffects/reference/marginaleffects.html" class="external-link">marginaleffects::marginaleffects()</a></code>; and <code><a href="reference/sim_setx.html">sim_setx()</a></code> computes predicted values at typical values of the covariates and differences between them, mirroring <code><a href="https://rdrr.io/pkg/Zelig/man/setx.html" class="external-link">Zelig::setx()</a></code> and <code><a href="https://rdrr.io/pkg/Zelig/man/setx1.html" class="external-link">Zelig::setx1()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Below is an example of performing g-computation for the ATT after logistic regression to compute the marginal log risk ratio and its confidence interval:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span>, package <span class="op">=</span> <span class="st">"MatchIt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit the model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span><span class="op">)</span>,</span>
<span>           data <span class="op">=</span> <span class="va">lalonde</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Simulate coefficients from a multivariate normal distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sim_coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sim.html">sim</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Apply a function that estimate the g-computation estimate for the ATT</span></span>
<span><span class="co">#to models with the estimated coefficients replaced by the simulated ones</span></span>
<span><span class="va">sim_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sim_apply.html">sim_apply</a></span><span class="op">(</span><span class="va">sim_coefs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lalonde</span>, <span class="va">treat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">d</span><span class="op">$</span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">d</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">d</span><span class="op">$</span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">d</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`E[Y(0)]` <span class="op">=</span> <span class="va">p0</span>, `E[Y(1)]` <span class="op">=</span> <span class="va">p1</span>, `log(RR)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">/</span> <span class="va">p0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_est</span></span>
<span><span class="co">#&gt; A `simbased_est` object (from `sim_apply()`)</span></span>
<span><span class="co">#&gt;  - 1000 simulated values</span></span>
<span><span class="co">#&gt;  - 3 quantities estimated:                   </span></span>
<span><span class="co">#&gt;  E[Y(0)]  0.2944381</span></span>
<span><span class="co">#&gt;  E[Y(1)]  0.2432432</span></span>
<span><span class="co">#&gt;  log(RR) -0.1910068</span></span>
<span></span>
<span><span class="co">#View the estimates, confidence intervals, and p-values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_est</span>, null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate  2.5 % 97.5 % P-value</span></span>
<span><span class="co">#&gt; E[Y(0)]    0.294  0.220  0.384       .</span></span>
<span><span class="co">#&gt; E[Y(1)]    0.243  0.199  0.360       .</span></span>
<span><span class="co">#&gt; log(RR)   -0.191 -0.479  0.330    0.79</span></span>
<span></span>
<span><span class="co">#Plot the resulting sampling distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_est</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="80%"></p>
<p><a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a> provides a shortcut for computing average marginal effects and comparisons between average adjusted predictions, <code><a href="reference/sim_ame.html">sim_ame()</a></code>, which is essentially a wrapper for <code><a href="reference/sim_apply.html">sim_apply()</a></code> with extra processing. We can compute the log marginal risk ratio below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Marginal risk ratio ATT, simulation-based</span></span>
<span><span class="va">sim_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sim_ame.html">sim_ame</a></span><span class="op">(</span><span class="va">sim_coefs</span>, var <span class="op">=</span> <span class="st">"treat"</span>, subset <span class="op">=</span> <span class="va">treat</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>                   contrast <span class="op">=</span> <span class="st">"log(RR)"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_est</span></span>
<span><span class="co">#&gt; A `simbased_est` object (from `sim_ame()`)</span></span>
<span><span class="co">#&gt;  - Average marginal effect of `treat`</span></span>
<span><span class="co">#&gt;  - 1000 simulated values</span></span>
<span><span class="co">#&gt;  - 3 quantities estimated:                   </span></span>
<span><span class="co">#&gt;  E[Y(0)]  0.2944381</span></span>
<span><span class="co">#&gt;  E[Y(1)]  0.2432432</span></span>
<span><span class="co">#&gt;  log(RR) -0.1910068</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_est</span>, null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate  2.5 % 97.5 % P-value</span></span>
<span><span class="co">#&gt; E[Y(0)]    0.294  0.220  0.384       .</span></span>
<span><span class="co">#&gt; E[Y(1)]    0.243  0.199  0.360       .</span></span>
<span><span class="co">#&gt; log(RR)   -0.191 -0.479  0.330    0.79</span></span></code></pre></div>
<p>We could have used <code>marginaleffects</code>, which uses the delta method instead:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Marginal risk ratio ATT, delta method-based</span></span>
<span><span class="fu">marginaleffects</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/marginaleffects/reference/comparisons.html" class="external-link">comparisons</a></span><span class="op">(</span><span class="va">fit</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>treat <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                             newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lalonde</span>, <span class="va">treat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                             transform_pre <span class="op">=</span> <span class="st">"lnratioavg"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Term              Contrast Effect Std. Error z value Pr(&gt;|z|)   2.5 % 97.5 %</span></span>
<span><span class="co">#&gt; 1 treat ln(mean(1) / mean(0)) -0.191     0.1925  -0.992  0.32119 -0.5684 0.1864</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model type:  glm </span></span>
<span><span class="co">#&gt; Prediction type:  response</span></span></code></pre></div>
<p>The plot of the simulated sampling distribution indicates that the sampling distribution for the log risk ratio is not normally distributed around the estimate, indicating that the delta method may be a poor approximation and the asymmetric confidence intervals produced using the simulation may be more valid.</p>
<p>If we want to compute the marginal risk ratio, we can do that using <code><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform()</a></code> on the already-produced output:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Transform estimates into new quantities of interest</span></span>
<span><span class="va">sim_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">sim_est</span>, `RR` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">`log(RR)`</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_est</span>, null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate  2.5 % 97.5 % P-value</span></span>
<span><span class="co">#&gt; E[Y(0)]    0.294  0.220  0.384       .</span></span>
<span><span class="co">#&gt; E[Y(1)]    0.243  0.199  0.360       .</span></span>
<span><span class="co">#&gt; log(RR)   -0.191 -0.479  0.330    0.79</span></span>
<span><span class="co">#&gt; RR         0.826  0.619  1.391    0.79</span></span></code></pre></div>
<p>We can also use <a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a> to compute predictions and first differences at set and typical values of the predictors, mimicking the functionality of <code>Zelig</code>’s <code>setx()</code> and <code>setx1()</code> functions, using <code><a href="reference/sim_setx.html">sim_setx()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predictions across age and treat at typical values</span></span>
<span><span class="co"># of the other predictors</span></span>
<span><span class="va">sim_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sim_setx.html">sim_setx</a></span><span class="op">(</span><span class="va">sim_coefs</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">20</span><span class="op">:</span><span class="fl">50</span>, treat <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                    verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot of predicted values across age for each value of treat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_est</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="80%"></p>
<p><a href="https://github.com/ngreifer/clarify" class="external-link">clarify</a> offers parallel processing for all estimation functions to speed up computation.</p>
<p>The methodology of simulation-based inference is described in King, Tomz, and Wittenberg (2000).</p>
<p>King, G., Tomz, M., &amp; Wittenberg, J. (2000). Making the Most of Statistical Analyses: Improving Interpretation and Presentation. <em>American Journal of Political Science</em>, 44(2), 347–361. <a href="https://doi.org/10.2307/2669316" class="external-link uri">https://doi.org/10.2307/2669316</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ngreifer/clarify/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ngreifer/clarify/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing clarify</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Noah Greifer <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3067-7154" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Steve Worthington <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9550-5797" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Stefano Iacus <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-4884-0047" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Gary King <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5327-7631" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=clarify" class="external-link"><img src="https://www.r-pkg.org/badges/version/clarify" alt="CRAN status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Noah Greifer, Steve Worthington, Stefano Iacus, Gary King.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
